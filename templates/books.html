{% extends "base.html" %}

{% block title %}Ù„ÛŒØ³Øª Ú©ØªØ§Ø¨â€ŒÙ‡Ø§{% endblock %}

{% block content %}
<div class="page">
    <div class="page-header">
        <h1>ğŸ“š Ù„ÛŒØ³Øª Ú©ØªØ§Ø¨â€ŒÙ‡Ø§</h1>
        <a href="/add_book" class="btn add">â• Ø§ÙØ²ÙˆØ¯Ù† Ú©ØªØ§Ø¨</a>
    </div>

    <!-- Ø¬Ø³Øªâ€ŒÙˆØ¬Ùˆ -->
    <div class="search-box">
        <input type="text" id="bookSearch" placeholder="Ø¬Ø³Øªâ€ŒÙˆØ¬Ùˆ Ø¨Ø± Ø§Ø³Ø§Ø³ Ù†Ø§Ù…ØŒ Ù…ÙˆØ¶ÙˆØ¹ ÛŒØ§ Ù‚ÙØ³Ù‡...">
    </div>

    <!-- ÙÛŒÙ„ØªØ± ÙˆØ¶Ø¹ÛŒØª -->
    <div class="filter-buttons">
        <button onclick="filterStatus('all')">ğŸ”„ Ù‡Ù…Ù‡</button>
        <button onclick="filterStatus('Ø¢Ø²Ø§Ø¯')">ğŸŸ¢ Ø¢Ø²Ø§Ø¯</button>
        <button onclick="filterStatus('Ø§Ù…Ø§Ù†Øª')">ğŸ”´ Ø§Ù…Ø§Ù†Øª Ø¯Ø§Ø¯Ù‡ Ø´Ø¯Ù‡</button>
    </div>

    <table class="data-table" id="booksTable">
        <thead>
            <tr>
                <th>Ù†Ø§Ù… Ú©ØªØ§Ø¨</th>
                <th>Ù…ÙˆØ¶ÙˆØ¹</th>
                <th>Ù‚ÙØ³Ù‡</th>
                <th>ÙˆØ¶Ø¹ÛŒØª</th>
                <th>Ø¹Ù…Ù„ÛŒØ§Øª</th>
            </tr>
        </thead>
        <tbody>
            {% for book in books %}
            <tr>
                <td>{{ book.title }}</td>
                <td>{{ book.subject }}</td>
                <td>{{ book.shelf }}</td>
                <td>{{ book.status }}</td>
                <td>
                    <a href="/edit_book/{{ book.id }}" class="btn edit">ÙˆÛŒØ±Ø§ÛŒØ´</a>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<script>
    const searchInput = document.getElementById("bookSearch");
    let currentFilter = "all";

    searchInput.addEventListener("keyup", applyFilters);

    function filterStatus(status) {
        currentFilter = status;
        applyFilters();
    }

    function applyFilters() {
        const filterText = searchInput.value.toLowerCase();
        const rows = document.querySelectorAll("#booksTable tbody tr");

        rows.forEach(row => {
            const title = row.cells[0].textContent.toLowerCase();
            const subject = row.cells[1].textContent.toLowerCase();
            const shelf = row.cells[2].textContent.toLowerCase();
            const status = row.cells[3].textContent;

            const matchText =
                title.includes(filterText) ||
                subject.includes(filterText) ||
                shelf.includes(filterText);

            const matchStatus =
                currentFilter === "all" ||
                status.includes(currentFilter);

            row.style.display = (matchText && matchStatus) ? "" : "none";
        });
    }
</script>
{% endblock %}
