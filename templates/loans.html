<!DOCTYPE html>
<html lang="fa">
<head>
    <meta charset="UTF-8">
    <title>Ø§Ù…Ø§Ù†Øªâ€ŒÙ‡Ø§</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <style>
        .filters {
            margin-bottom: 20px;
            text-align: right;
        }
        .filters input {
            padding: 6px;
            margin-left: 10px;
        }
    </style>
</head>
<body>

<div class="page">
    <h1>ğŸ“š Ù„ÛŒØ³Øª Ø§Ù…Ø§Ù†Øªâ€ŒÙ‡Ø§</h1>

    <div class="filters">
        ğŸ” Ø¬Ø³Øªâ€ŒÙˆØ¬Ùˆ:
        <input type="text" id="searchInput" placeholder="Ù†Ø§Ù… Ø¹Ø¶Ùˆ ÛŒØ§ Ú©ØªØ§Ø¨">

        ğŸ“… Ø§Ø²:
        <input type="date" id="fromDate">

        ØªØ§:
        <input type="date" id="toDate">
    </div>

    <table class="data-table" id="loansTable">
        <thead>
            <tr>
                <th>Ø¹Ø¶Ùˆ</th>
                <th>Ú©ØªØ§Ø¨</th>
                <th>ØªØ§Ø±ÛŒØ® Ø§Ù…Ø§Ù†Øª</th>
                <th>ÙˆØ¶Ø¹ÛŒØª</th>
            </tr>
        </thead>
        <tbody>
            {% for loan in loans %}
            <tr>
                <td>{{ loan.member_name }}</td>
                <td>{{ loan.book_title }}</td>
                <td class="loan-date">{{ loan.loan_date }}</td>
                <td>
                    {% if loan.return_date == None %}
                        <a href="/return_book/{{ loan.id }}/{{ loan.book_id }}" class="btn return">
                            ØªØ­ÙˆÛŒÙ„ Ú©ØªØ§Ø¨
                        </a>
                    {% else %}
                        âœ” ØªØ­ÙˆÛŒÙ„ Ø´Ø¯Ù‡
                    {% endif %}
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<script>
    const searchInput = document.getElementById("searchInput");
    const fromDate = document.getElementById("fromDate");
    const toDate = document.getElementById("toDate");
    const rows = document.querySelectorAll("#loansTable tbody tr");

    function filterLoans() {
        const search = searchInput.value.toLowerCase();
        const from = fromDate.value;
        const to = toDate.value;

        rows.forEach(row => {
            const member = row.cells[0].textContent.toLowerCase();
            const book = row.cells[1].textContent.toLowerCase();
            const loanDate = row.querySelector(".loan-date").textContent;

            let visible = true;

            if (search && !(member.includes(search) || book.includes(search))) {
                visible = false;
            }

            if (from && loanDate < from) visible = false;
            if (to && loanDate > to) visible = false;

            row.style.display = visible ? "" : "none";
        });
    }

    searchInput.addEventListener("keyup", filterLoans);
    fromDate.addEventListener("change", filterLoans);
    toDate.addEventListener("change", filterLoans);
</script>

</body>
</html>
