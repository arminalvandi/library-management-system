<!DOCTYPE html>
<html lang="fa">
<head>
    <meta charset="UTF-8">
    <title>Ø§Ù…Ø§Ù†Øªâ€ŒÙ‡Ø§</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">

    <style>
        .search-box {
            margin: 20px 0;
            text-align: right;
        }
        .search-box input, .search-box select {
            padding: 8px;
            font-size: 14px;
            margin-left: 10px;
        }
    </style>
</head>
<body>

<div class="page">
    <h1>ğŸ“š Ù„ÛŒØ³Øª Ø§Ù…Ø§Ù†Øªâ€ŒÙ‡Ø§</h1>

    <div class="search-box">
        ğŸ” Ø¬Ø³Øªâ€ŒÙˆØ¬Ùˆ:
        <input type="text" id="searchInput" placeholder="Ù†Ø§Ù… Ø¹Ø¶Ùˆ ÛŒØ§ Ú©ØªØ§Ø¨...">

        ÙˆØ¶Ø¹ÛŒØª:
        <select id="statusFilter">
            <option value="all">Ù‡Ù…Ù‡</option>
            <option value="borrowed">Ø¯Ø± Ø§Ù…Ø§Ù†Øª</option>
            <option value="returned">ØªØ­ÙˆÛŒÙ„ Ø´Ø¯Ù‡</option>
        </select>
    </div>

    <table class="data-table" id="loansTable">
        <thead>
            <tr>
                <th>Ø¹Ø¶Ùˆ</th>
                <th>Ú©ØªØ§Ø¨</th>
                <th>ØªØ§Ø±ÛŒØ® Ø§Ù…Ø§Ù†Øª</th>
                <th>ÙˆØ¶Ø¹ÛŒØª</th>
            </tr>
        </thead>
        <tbody>
            {% for loan in loans %}
            <tr data-status="{% if loan.return_date == None %}borrowed{% else %}returned{% endif %}">
                <td>{{ loan.member_name }}</td>
                <td>{{ loan.book_title }}</td>
                <td>{{ loan.loan_date }}</td>
                <td>
                    {% if loan.return_date == None %}
                        <a href="/return_book/{{ loan.id }}" class="btn return">
                            ØªØ­ÙˆÛŒÙ„ Ú©ØªØ§Ø¨
                        </a>
                    {% else %}
                        âœ” ØªØ­ÙˆÛŒÙ„ Ø´Ø¯Ù‡
                    {% endif %}
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<script>
    const searchInput = document.getElementById("searchInput");
    const statusFilter = document.getElementById("statusFilter");
    const rows = document.querySelectorAll("#loansTable tbody tr");

    function filterTable() {
        const searchValue = searchInput.value.toLowerCase();
        const statusValue = statusFilter.value;

        rows.forEach(row => {
            const member = row.cells[0].textContent.toLowerCase();
            const book = row.cells[1].textContent.toLowerCase();
            const status = row.getAttribute("data-status");

            const matchesSearch =
                member.includes(searchValue) || book.includes(searchValue);

            const matchesStatus =
                statusValue === "all" || status === statusValue;

            row.style.display = (matchesSearch && matchesStatus) ? "" : "none";
        });
    }

    searchInput.addEventListener("keyup", filterTable);
    statusFilter.addEventListener("change", filterTable);
</script>

</body>
</html>
